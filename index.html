<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Приглашение на свадьбу: Гумар и Диёра</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Lora:ital,wght@0,400;0,500;0,600;1,400&display=swap"
      rel="stylesheet"
    />
    <style>
      @font-face {
        font-family: "CandleScript";
        src: url("./fonts/Candlescript Neue Basic - Demo Version.ttf")
          format("truetype");
        font-weight: normal;
        font-style: normal;
      }

      body {
        margin: 0;
        font-family: "Lora", serif;
        position: relative;
        min-height: 100svh;
      }

      html {
        height: 100%;
        margin: 0;
      }

      body::before {
        content: "";
        position: fixed; /* NOT fixed */
        inset: 0;
        background-image: url(./images/bg.jpeg);
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        z-index: -1;
      }

      @media (max-width: 767px) {
        body::before {
          background-position: center top;
        }
      }

      .font-secondary {
        font-family: "Great Vibes", cursive;
      }

      .font-accent {
        font-family: "CandleScript", "Great Vibes", cursive;
      }

      /* Smooth fade-in animation */
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }

        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .fade-in {
        animation: fadeIn 1s ease-out forwards;
      }

      .card-bg {
        background: rgba(255, 255, 255, 0.97);
        backdrop-filter: blur(10px);
      }

      .calendar {
        display: grid;
        grid-template-columns: repeat(7, minmax(0, 1fr));
        gap: 6px;
        max-width: 100%;
      }

      .calendar .calendar-header {
        text-align: center;
        padding: 8px 6px;
        color: #6b7280;
        font-weight: 600;
      }

      .calendar-day {
        min-height: 48px;
        padding: 4px;
        display: flex;
        justify-content: center;
        align-items: center;
        color: #374151;
      }

      .calendar-day.empty {
        background: transparent;
        opacity: 0.5;
      }

      .calendar-day.highlighted {
        background-image: url(./images/pearl_isolated.png);
        background-size: contain;
        background-position: center;
        background-repeat: no-repeat;
      }

      @media (max-width: 480px) {
        .calendar-day {
          min-height: 52px;
          padding: 6px;
        }
      }

      .timeline-item {
        position: relative;
      }

      .timeline-item:not(:last-child)::after {
        content: "";
        position: absolute;
        left: 50%;
        top: 100%;
        width: 0;
        height: 64px;
        border-left: 2px dotted #39180e;
        transform: translateX(-50%);
      }

      .timeline-item:not(:last-child)::before {
        content: "";
        position: absolute;
        left: 50%;
        top: calc(100% + 32px);
        width: 20px;
        height: 20px;
        background-image: url(./images/pearl_isolated.png);
        background-size: contain;
        background-position: center;
        background-repeat: no-repeat;
        transform: translate(-50%, -50%);
        z-index: 1;
      }

      @media (min-width: 640px) {
        .timeline-item:not(:last-child)::after {
          left: 60px;
        }
        .timeline-item:not(:last-child)::before {
          left: 60px;
        }
      }

      /* Music control button */
      .music-control {
        position: fixed;
        bottom: 24px;
        right: 24px;
        z-index: 1000;
        width: 56px;
        height: 56px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 2px solid rgba(57, 24, 14, 0.1);
      }

      .music-control:hover {
        transform: scale(1.1);
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
      }

      .music-control svg {
        width: 24px;
        height: 24px;
        fill: #39180e;
      }

      /* Landing page styles */
      #landing-page {
        position: fixed;
        inset: 0;
        z-index: 9999;
        display: flex;
        align-items: center;
        justify-content: center;
        background-image: url(./images/bg.jpeg);
        background-size: cover;
        background-position: center;
        transition:
          opacity 0.8s ease,
          visibility 0.8s ease;
      }

      #landing-page.hidden {
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
      }

      .landing-content {
        text-align: center;
        padding: 2rem;
      }

      .open-button {
        margin-top: 2rem;
        padding: 0.7rem 2rem;
        background: #39180e;
        color: white;
        border: none;
        border-radius: 0.5rem;
        font-size: 1.25rem;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .open-button:hover {
        background: #8b5a3c;
        box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
      }

      .open-button:active {
        transform: translateY(0);
      }

      #main-content {
        opacity: 0;
        transition: opacity 1s ease 0.5s;
      }

      #main-content.visible {
        opacity: 1;
      }

      .music-control {
        opacity: 0;
        visibility: hidden;
        transition:
          opacity 0.5s ease 1.5s,
          visibility 0.5s ease 1.5s;
      }

      .music-control.visible {
        opacity: 1;
        visibility: visible;
      }
    </style>
  </head>

  <body class="antialiased">
    <!-- Landing Page -->
    <div id="landing-page">
      <section
        class="min-h-screen flex flex-col items-center justify-center p-4 sm:p-6 pt-32 sm:pt-40"
      >
        <div
          class="w-full max-w-lg card-bg rounded-t-[999px] rounded-b-lg relative fade-in"
        >
          <div
            class="absolute -top-12 sm:-top-16 left-1/2 -translate-x-1/2 z-20"
          >
            <img
              src="./images/pearl.png"
              alt="Pearl decoration"
              class="w-20 h-auto sm:w-24 drop-shadow-lg pointer-events-none"
            />
          </div>
          <div class="pt-24 sm:pt-32 pb-12 sm:pb-16 px-12 text-center">
            <div class="mb-8 sm:mb-12 mx-8 sm:mx-16">
              <h1 class="text-left font-accent text-5xl sm:text-6xl">
                Гумар
                <span class="font-secondary text-2xl">&</span>
              </h1>
              <h1 class="text-right font-accent text-5xl sm:text-6xl">Диёра</h1>
            </div>
            <p class="text-gray-700">Приглашение на свадьбу</p>
            <button
              id="open-invitation"
              class="open-button font-secondary text-2xl"
            >
              Открыть
            </button>
          </div>
        </div>
      </section>
    </div>

    <!-- Background Music -->
    <audio id="background-music" loop>
      <source src="./music/song.mp3" type="audio/mpeg" />
      Your browser does not support the audio element.
    </audio>

    <!-- Music Control Button -->
    <button id="music-toggle" class="music-control" aria-label="Toggle music">
      <svg
        id="play-icon"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path d="M8 5v14l11-7z" />
      </svg>
      <svg
        id="pause-icon"
        style="display: none"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z" />
      </svg>
    </button>

    <!-- Main Invitation Content -->
    <div id="main-content">
      <section
        class="min-h-screen flex flex-col items-center justify-center p-4 sm:p-6 pt-32 sm:pt-40"
      >
        <div
          class="w-full max-w-lg card-bg rounded-t-[999px] rounded-b-lg relative fade-in"
        >
          <!-- Pearl decoration -->
          <div
            class="absolute -top-12 sm:-top-16 left-1/2 -translate-x-1/2 z-20"
          >
            <img
              src="./images/pearl.png"
              alt="Pearl decoration"
              class="w-20 h-auto sm:w-24 drop-shadow-lg pointer-events-none"
            />
          </div>

          <!-- Main content container with proper padding -->
          <div class="pt-24 sm:pt-32 pb-12 sm:pb-16 px-12 text-center">
            <div class="mb-8 sm:mb-12 mx-8 sm:mx-16">
              <h1 class="text-left font-accent text-5xl sm:text-6xl">
                Гумар
                <span class="font-secondary text-2xl">&</span>
              </h1>

              <h1 class="text-right font-accent text-5xl sm:text-6xl">Диёра</h1>
            </div>
            <div class="space-y-3 sm:space-y-4">
              <!-- Calendar -->
              <div class="mt-8">
                <h3
                  class="font-secondary text-2xl sm:text-3xl font-medium text-gray-700 mb-4"
                >
                  Апрель 2026
                </h3>

                <div
                  class="calendar"
                  role="grid"
                  aria-label="Календарь: Апрель 2026"
                >
                  <!-- Week day headers -->
                  <div class="calendar-header" role="columnheader">Пн</div>
                  <div class="calendar-header" role="columnheader">Вт</div>
                  <div class="calendar-header" role="columnheader">Ср</div>
                  <div class="calendar-header" role="columnheader">Чт</div>
                  <div class="calendar-header" role="columnheader">Пт</div>
                  <div class="calendar-header" role="columnheader">Сб</div>
                  <div class="calendar-header" role="columnheader">Вс</div>

                  <!-- Empty cells for alignment (April 2026 starts on Wednesday) -->
                  <div
                    class="calendar-day empty"
                    role="gridcell"
                    aria-hidden="true"
                  ></div>
                  <div
                    class="calendar-day empty"
                    role="gridcell"
                    aria-hidden="true"
                  ></div>

                  <!-- Days -->
                  <div class="calendar-day" role="gridcell">1</div>
                  <div class="calendar-day" role="gridcell">2</div>
                  <div class="calendar-day" role="gridcell">3</div>
                  <div class="calendar-day" role="gridcell">4</div>
                  <div class="calendar-day" role="gridcell">5</div>
                  <div class="calendar-day" role="gridcell">6</div>
                  <div class="calendar-day" role="gridcell">7</div>
                  <div class="calendar-day" role="gridcell">8</div>
                  <div class="calendar-day" role="gridcell">9</div>
                  <div class="calendar-day" role="gridcell">10</div>
                  <div
                    class="calendar-day highlighted"
                    role="gridcell"
                    aria-label="День свадьбы: 11 апреля"
                  >
                    11
                  </div>
                  <div class="calendar-day" role="gridcell">12</div>
                  <div class="calendar-day" role="gridcell">13</div>
                  <div class="calendar-day" role="gridcell">14</div>
                  <div class="calendar-day" role="gridcell">15</div>
                  <div class="calendar-day" role="gridcell">16</div>
                  <div class="calendar-day" role="gridcell">17</div>
                  <div class="calendar-day" role="gridcell">18</div>
                  <div class="calendar-day" role="gridcell">19</div>
                  <div class="calendar-day" role="gridcell">20</div>
                  <div class="calendar-day" role="gridcell">21</div>
                  <div class="calendar-day" role="gridcell">22</div>
                  <div class="calendar-day" role="gridcell">23</div>
                  <div class="calendar-day" role="gridcell">24</div>
                  <div class="calendar-day" role="gridcell">25</div>
                  <div class="calendar-day" role="gridcell">26</div>
                  <div class="calendar-day" role="gridcell">27</div>
                  <div class="calendar-day" role="gridcell">28</div>
                  <div class="calendar-day" role="gridcell">29</div>
                  <div class="calendar-day" role="gridcell">30</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <section
        class="min-h-screen flex flex-col items-center justify-center px-12"
      >
        <div class="w-full max-w-lg rounded-lg fade-in">
          <div class="space-y-6 sm:space-y-8">
            <h2
              class="text-center font-accent text-4xl sm:text-5xl text-gray-800"
            >
              Дорогие родные и друзья
            </h2>
            <div class="space-y-4 text-center text-gray-700 leading-relaxed">
              <p class="text-lg sm:text-xl">
                Мы будем счастливы разделить с вами один из самых важных и
                трогательных дней в нашей жизни.
              </p>
              <p class="text-lg sm:text-xl">
                С большим удовольствием приглашаем вас стать частью нашего
                праздника любви и начала новой семейной истории.
              </p>
              <div class="flex justify-center">
                <img
                  src="./images/heart.png"
                  alt="Heart decoration"
                  class="w-32 h-32 object-cover pointer-events-none"
                />
              </div>
              <div class="mt-8">
                <h3
                  class="text-center font-secondary text-3xl sm:text-4xl font-medium text-gray-700 mb-4"
                >
                  11 Апрель 2026 <br />
                  ресторан Santini
                </h3>
              </div>
            </div>
          </div>
        </div>
      </section>
      <section
        class="min-h-screen flex flex-col items-center justify-center p-4 sm:p-6 pt-32 sm:pt-40"
      >
        <div
          class="w-full max-w-lg card-bg rounded-t-[999px] rounded-b-lg relative fade-in"
        >
          <div
            class="absolute -top-12 sm:-top-16 left-1/2 -translate-x-1/2 z-20"
          >
            <img
              src="./images/shell.png"
              alt="Pearl decoration"
              class="w-20 h-auto sm:w-24 drop-shadow-lg pointer-events-none"
            />
          </div>

          <div class="pt-24 sm:pt-32 pb-12 sm:pb-16 px-12 text-center">
            <div class="mb-8 sm:mb-12 mx-8 sm:mx-16">
              <h2 class="text-center font-accent text-5xl sm:text-6xl">
                Программа
              </h2>
            </div>
            <div class="timeline-container">
              <div
                class="timeline-item flex flex-col sm:flex-row items-center gap-6 sm:gap-12 mb-16 sm:mb-16 mx-8 sm:mx-8"
              >
                <div class="flex-shrink-0 sm:w-1/3 flex justify-center">
                  <img
                    src="./images/guests.svg"
                    class="w-24 h-24 object-contain pointer-events-none"
                  />
                </div>
                <div class="flex-1 sm:w-2/3 text-center sm:text-left">
                  <h3 class="font-secondary text-3xl sm:text-4xl">18:00</h3>
                  <p class="text-base sm:text-lg">Сбор гостей</p>
                </div>
              </div>
              <div
                class="timeline-item flex flex-col sm:flex-row items-center gap-6 sm:gap-12 mb-16 sm:mb-16 mx-8 sm:mx-8"
              >
                <div class="flex-shrink-0 sm:w-1/3 flex justify-center">
                  <img
                    src="./images/groom_bride.svg"
                    class="w-24 h-24 object-contain pointer-events-none"
                  />
                </div>
                <div class="flex-1 sm:w-2/3 text-center sm:text-left">
                  <h3 class="font-secondary text-3xl sm:text-4xl">18:30</h3>
                  <p class="text-base sm:text-lg">Встреча жениха и невесты</p>
                </div>
              </div>
              <div
                class="timeline-item flex flex-col sm:flex-row items-center gap-6 sm:gap-12 mb-16 sm:mb-16 mx-8 sm:mx-8"
              >
                <div class="flex-shrink-0 sm:w-1/3 flex justify-center">
                  <img
                    src="./images/dinner.svg"
                    class="w-24 h-24 object-contain pointer-events-none"
                  />
                </div>
                <div class="flex-1 sm:w-2/3 text-center sm:text-left">
                  <h3 class="font-secondary text-3xl sm:text-4xl">19:00</h3>
                  <p class="text-base sm:text-lg">Начало банкета</p>
                </div>
              </div>
              <div
                class="timeline-item flex flex-col sm:flex-row items-center gap-6 sm:gap-12 mx-8 sm:mx-8"
              >
                <div class="flex-shrink-0 sm:w-1/3 flex justify-center">
                  <img
                    src="./images/final.svg"
                    class="w-24 h-24 object-contain pointer-events-none"
                  />
                </div>
                <div class="flex-1 sm:w-2/3 text-center sm:text-left">
                  <h3 class="font-secondary text-3xl sm:text-4xl">23:00</h3>
                  <p class="text-base sm:text-lg">Завершение вечера</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <section
        class="min-h-screen flex flex-col items-center justify-center p-4 sm:p-6 pt-32 sm:pt-40"
      >
        <div
          class="w-full max-w-lg card-bg rounded-t-[999px] rounded-b-lg relative fade-in"
        >
          <div
            class="absolute -top-12 sm:-top-16 left-1/2 -translate-x-1/2 z-20"
          >
            <img
              src="./images/pearl.png"
              alt="Pearl decoration"
              class="w-20 h-auto sm:w-24 drop-shadow-lg pointer-events-none"
            />
          </div>

          <div class="pt-24 sm:pt-32 pb-12 sm:pb-16 px-8 sm:px-12">
            <div class="mb-8 sm:mb-12 text-center">
              <h2 class="font-accent text-5xl sm:text-6xl mb-8">Анкета</h2>
            </div>

            <form class="space-y-8">
              <!-- Family Name Input -->
              <div class="text-left">
                <label
                  for="family-name"
                  class="font-secondary text-2xl sm:text-3xl mb-4 text-gray-800 block"
                >
                  Ваше имя или семейная фамилия
                </label>
                <input
                  type="text"
                  id="family-name"
                  name="family-name"
                  class="w-full px-4 py-3 text-lg border-2 border-gray-300 rounded-lg focus:border-gray-500 focus:outline-none"
                  placeholder="Введите ваше имя или фамилию"
                />
              </div>

              <!-- Question 1 -->
              <div class="text-left">
                <h3
                  class="font-secondary text-2xl sm:text-3xl mb-4 text-gray-800"
                >
                  Вы сможете прийти?
                </h3>
                <div class="space-y-3 ml-4">
                  <label class="flex items-center cursor-pointer">
                    <input
                      type="radio"
                      name="attendance"
                      value="yes"
                      class="w-5 h-5 text-gray-700"
                    />
                    <span class="ml-3 text-lg sm:text-xl text-gray-700"
                      >Да, с радостью</span
                    >
                  </label>
                  <label class="flex items-center cursor-pointer">
                    <input
                      type="radio"
                      name="attendance"
                      value="no"
                      class="w-5 h-5 text-gray-700"
                    />
                    <span class="ml-3 text-lg sm:text-xl text-gray-700"
                      >К сожалению, не смогу</span
                    >
                  </label>
                </div>
              </div>

              <!-- Question 2 -->
              <div class="text-left">
                <h3
                  class="font-secondary text-2xl sm:text-3xl mb-4 text-gray-800"
                >
                  Какой алкоголь вы предпочитаете?
                </h3>
                <p class="text-sm sm:text-base text-gray-600 mb-3 ml-4">
                  (можно выбрать несколько вариантов)
                </p>
                <div class="space-y-3 ml-4">
                  <label class="flex items-center cursor-pointer">
                    <input
                      type="checkbox"
                      name="drink"
                      value="red-wine"
                      class="w-5 h-5 text-gray-700"
                    />
                    <span class="ml-3 text-lg sm:text-xl text-gray-700"
                      >Вино красное</span
                    >
                  </label>
                  <label class="flex items-center cursor-pointer">
                    <input
                      type="checkbox"
                      name="drink"
                      value="white-wine"
                      class="w-5 h-5 text-gray-700"
                    />
                    <span class="ml-3 text-lg sm:text-xl text-gray-700"
                      >Вино белое</span
                    >
                  </label>
                  <label class="flex items-center cursor-pointer">
                    <input
                      type="checkbox"
                      name="drink"
                      value="champagne"
                      class="w-5 h-5 text-gray-700"
                    />
                    <span class="ml-3 text-lg sm:text-xl text-gray-700"
                      >Шампанское</span
                    >
                  </label>
                  <label class="flex items-center cursor-pointer">
                    <input
                      type="checkbox"
                      name="drink"
                      value="spirits"
                      class="w-5 h-5 text-gray-700"
                    />
                    <span class="ml-3 text-lg sm:text-xl text-gray-700"
                      >Крепкий алкоголь</span
                    >
                  </label>
                  <label class="flex items-center cursor-pointer">
                    <input
                      type="checkbox"
                      name="drink"
                      value="none"
                      class="w-5 h-5 text-gray-700"
                    />
                    <span class="ml-3 text-lg sm:text-xl text-gray-700"
                      >Не употребляю</span
                    >
                  </label>
                </div>
              </div>

              <!-- Submit Button -->
              <div class="text-center pt-4">
                <button
                  type="submit"
                  class="w-full px-8 py-3 text-white font-secondary text-xl sm:text-2xl rounded-lg transition-all duration-300 shadow-md hover:shadow-lg"
                  style="background: #39180e"
                  onmouseover="this.style.background = '#8B5A3C'"
                  onmouseout="this.style.background = '#39180e'"
                >
                  Отправить
                </button>
              </div>
            </form>
          </div>
        </div>
      </section>
      <section
        class="min-h-screen flex flex-col items-center justify-center px-12"
      >
        <div class="w-full max-w-lg rounded-lg fade-in">
          <div class="space-y-6 sm:space-y-8">
            <div class="space-y-6 text-center text-gray-700 leading-relaxed">
              <p class="text-xl sm:text-2xl font-medium">
                Будем рады вас видеть
              </p>
              <div class="flex justify-center">
                <img
                  src="./images/heart.png"
                  alt="Heart decoration"
                  class="w-32 h-32 object-cover pointer-events-none"
                />
              </div>
              <div class="mx-16 sm:mx-24">
                <h2 class="text-left font-accent text-5xl sm:text-6xl">
                  Гумар
                  <span class="font-secondary text-2xl">&</span>
                </h2>
                <h2 class="text-right font-accent text-5xl sm:text-6xl">
                  Диёра
                </h2>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
    <!-- End Main Content -->

    <script>
      // Landing page and invitation opening
      document.addEventListener("DOMContentLoaded", function () {
        const landingPage = document.getElementById("landing-page");
        const mainContent = document.getElementById("main-content");
        const openButton = document.getElementById("open-invitation");
        const audio = document.getElementById("background-music");
        const musicToggle = document.getElementById("music-toggle");

        openButton.addEventListener("click", function () {
          // Hide landing page
          landingPage.classList.add("hidden");

          // Show main content
          mainContent.classList.add("visible");

          // Show music control
          musicToggle.classList.add("visible");

          // Start music
          audio.play().catch((error) => {
            console.log("Audio play failed:", error);
          });
        });
      });

      // Music player functionality
      document.addEventListener("DOMContentLoaded", function () {
        const audio = document.getElementById("background-music");
        const musicToggle = document.getElementById("music-toggle");
        const playIcon = document.getElementById("play-icon");
        const pauseIcon = document.getElementById("pause-icon");

        // Try to autoplay (may be blocked by browser)
        audio.play().catch(() => {
          // Autoplay was prevented, show play icon
          console.log("Autoplay prevented. User interaction required.");
        });

        // Toggle music on button click
        musicToggle.addEventListener("click", function () {
          if (audio.paused) {
            audio.play();
            playIcon.style.display = "none";
            pauseIcon.style.display = "block";
          } else {
            audio.pause();
            playIcon.style.display = "block";
            pauseIcon.style.display = "none";
          }
        });

        // Update icon when audio starts playing
        audio.addEventListener("play", function () {
          playIcon.style.display = "none";
          pauseIcon.style.display = "block";
        });

        // Update icon when audio is paused
        audio.addEventListener("pause", function () {
          playIcon.style.display = "block";
          pauseIcon.style.display = "none";
        });
      });

      // Form validation and conditional logic
      document.addEventListener("DOMContentLoaded", function () {
        const form = document.querySelector("form");
        const familyNameInput = document.getElementById("family-name");
        const attendanceRadios = document.querySelectorAll(
          'input[name="attendance"]',
        );
        const drinkCheckboxes = document.querySelectorAll(
          'input[name="drink"]',
        );
        const drinkSection = drinkCheckboxes[0].closest(".text-left");
        const submitButton = form.querySelector('button[type="submit"]');

        // Replace this URL with your Google Apps Script Web App URL
        const GOOGLE_SCRIPT_URL = "YOUR_GOOGLE_SCRIPT_URL_HERE";

        // Handle attendance change - disable alcohol section if can't attend
        attendanceRadios.forEach((radio) => {
          radio.addEventListener("change", function () {
            if (this.value === "no") {
              // Disable all drink checkboxes and uncheck them
              drinkCheckboxes.forEach((checkbox) => {
                checkbox.disabled = true;
                checkbox.checked = false;
              });
              drinkSection.style.opacity = "0.5";
            } else {
              // Enable all drink checkboxes
              drinkCheckboxes.forEach((checkbox) => {
                checkbox.disabled = false;
              });
              drinkSection.style.opacity = "1";
            }
          });
        });

        // Form submission validation and sending
        form.addEventListener("submit", async function (e) {
          e.preventDefault();

          // Validate name
          const name = familyNameInput.value.trim();
          if (name === "") {
            alert("Пожалуйста, введите ваше имя или фамилию");
            familyNameInput.focus();
            return false;
          }

          if (name.length < 2) {
            alert("Имя должно содержать не менее 2 символов");
            familyNameInput.focus();
            return false;
          }

          // Validate name contains only letters, spaces, and hyphens
          const nameRegex = /^[а-яёА-ЯЁa-zA-Z\s\-]+$/;
          if (!nameRegex.test(name)) {
            alert("Имя может содержать только буквы, пробелы и дефисы");
            familyNameInput.focus();
            return false;
          }

          // Validate attendance selection
          const attendanceSelected = Array.from(attendanceRadios).some(
            (radio) => radio.checked,
          );
          if (!attendanceSelected) {
            alert("Пожалуйста, укажите, сможете ли вы прийти");
            attendanceRadios[0].focus();
            return false;
          }

          // Validate drink selection only if attending
          const attendance = document.querySelector(
            'input[name="attendance"]:checked',
          ).value;
          const isAttending = attendance === "yes";

          if (isAttending) {
            const drinkSelected = Array.from(drinkCheckboxes).some(
              (checkbox) => checkbox.checked,
            );
            if (!drinkSelected) {
              alert("Пожалуйста, выберите предпочитаемый алкоголь");
              drinkCheckboxes[0].focus();
              return false;
            }
          }

          // Collect form data
          const selectedDrinks = Array.from(drinkCheckboxes)
            .filter((cb) => cb.checked)
            .map((cb) => cb.nextElementSibling.textContent.trim())
            .join(", ");

          const formData = {
            name: name,
            attendance: isAttending
              ? "Да, с радостью"
              : "К сожалению, не смогу",
            drinks: isAttending ? selectedDrinks : "N/A",
            timestamp: new Date().toLocaleString("ru-RU"),
          };

          // Disable submit button and show loading state
          submitButton.disabled = true;
          submitButton.textContent = "Отправка...";

          try {
            // Send data to Google Sheets
            const response = await fetch(
              "https://script.google.com/macros/s/AKfycbzUrFMkWL7LA-Z74SinMWkKmJMFbyPVP-nUMU1_ksf5xPaMvS0XrFnMHbneT1ZWZnagDg/exec",
              {
                method: "POST",
                mode: "no-cors",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify(formData),
              },
            );

            // Show success message
            alert("Спасибо! Ваш ответ принят.");
            form.reset();
          } catch (error) {
            console.error("Error:", error);
            alert(
              "Произошла ошибка при отправке. Пожалуйста, попробуйте еще раз.",
            );
          } finally {
            // Re-enable submit button
            submitButton.disabled = false;
            submitButton.textContent = "Отправить";
          }
        });
      });
    </script>
  </body>
</html>
